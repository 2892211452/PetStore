<!DOCTYPE html>
<html lang="en">
<head>
<title>Single</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<meta name="keywords" content="" />
<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<!-- bootstrap-css -->
<link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
<!--// bootstrap-css -->
<!-- css -->
<link rel="stylesheet" href="css/style.css" type="text/css" media="all" />
<!--// css -->
<!-- font-awesome icons -->
<link href="css/font-awesome.css" rel="stylesheet"> 
<!-- //font-awesome icons -->
<link rel="stylesheet" href="css/lightbox.css">
<!-- font -->
<script src="https://cdn.staticfile.org/vue/2.2.2/vue.min.js"></script>

<link href='http://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
<link href="http://fonts.googleapis.com/css?family=Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
<link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:400,700italic,700,400italic,300italic,300' rel='stylesheet' type='text/css'>
<!-- //font -->
<script src="js/jquery-1.11.1.min.js"></script>
<script src="js/bootstrap.js"></script>
<script type="text/javascript">
	jQuery(document).ready(function($) {
		$(".scroll").click(function(event){		
			event.preventDefault();
			$('html,body').animate({scrollTop:$(this.hash).offset().top},1000);
		});
	});
</script> 
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<![endif]-->
</head>
<body>
<div id="app">
	<!-- banner -->
	<div class="banner about-banner">
		<div class="header">
	<div class="container"><div class="header-left"><div class="w3layouts-logo"><h1><a href="index.html">Pet <span>Store</span></a></h1></div></div> <div class="header-right"><div class="top-nav"><nav class="navbar navbar-default"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div> <div id="bs-example-navbar-collapse-1" class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="main" class="active">主页</a></li> <li><a href="clasify">分类</a></li> <li><a href="user">个人</a></li> <li><a href="http://localhost:3001/cart">购物车</a></li> <li><a href="http://localhost:3001/login">卖家</a></li> <li><a href="/login">注销</a></li></ul> <div class="clearfix"></div></div></nav></div> <div class="agileinfo-social-grids"><div class="col-lg-6" style="width: 300px;"><div class="input-group"><input type="text" placeholder="请输入搜索内容" class="form-control"> <span class="input-group-btn"><button type="button" class="btn btn-default">搜索</button></span></div></div></div> <div class="clearfix"></div></div> <div class="clearfix"></div></div>
		
		</div>
		<div class="about-heading">	
			<div class="container">
				<h2>Blog Post</h2>
			</div>
		</div>
	</div>
	<!-- //banner -->
	<!-- blog -->
	<div class="blog">
			<!-- container -->
			<div class="container">
				<div class="col-md-8 blog-top-left-grid">
					<div class="left-blog left-single">
						<div class="blog-left">
							<div class="single-left-left">
								<p>Provided By <a href="#">{{provider}}</a> &nbsp;&nbsp; {{time}} &nbsp;&nbsp; <a href="#"></a></p>
								<img :src="imgUrl" alt="" />
							</div>
							<div class="blog-left-bottom">
								<p>
								{{des}}
								</p>
							</div>
							
						</div>
					
						<div class="opinion">
							<h3>How Many You Want To Buy</h3>
							<form @submit.prevent="" > 
								<!-- Single button -->

								<input type="text" name="Number" placeholder="Number" required="" v-model:value="Number">


<div class="btn-group" v-model:value="Select">
  <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    {{itemId}} <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li v-for="item in itemIDs"><a v-on:click="clickS(item)">{{item}}</a></li>
  
  </ul>
</div>



								<input type="submit" value="Buy" v-on:click.stop="buy">
							</form>
						</div>
					</div>
				</div>
				<div class="col-md-4 blog-top-right-grid">
					<div class="Categories">
						<h3>Tags</h3>
						<ul>
							<li v-for="item in tags"><a href="#" >{{item}}</a></li>

						</ul>
					</div>
					
				</div>
				<div class="clearfix"> </div>
			</div>
			<!-- //container -->
	</div>
	<!-- //blog -->
	<!-- footer -->
	<footer>
		<div class="container">
			<div class="agileits-w3layouts-footer-grids">
				<div class="col-md-4 footer-left">
					<h3>
						<a href="index.html">Cat <span>Club</span></a>
					</h3>
					<div class="footer-social-grids">
						<ul>
							<li><a href="#"><i class="fa fa-facebook"></i></a></li>
							<li><a href="#"><i class="fa fa-twitter"></i></a></li>
							<li><a href="#"><i class="fa fa-rss"></i></a></li>
						</ul>
					</div>
				</div>
				<div class="col-md-4 footer-left">
					<h4>Navigation</h4>
					<div class="col-md-6 footer-grid-left">
						<ul>
							<li><a class="active" href="index.html">Home</a></li>
							<li><a href="about.html">About</a></li>								
							<li><a href="gallery.html">Gallery</a></li>
							<li><a href="icons.html">Icons</a></li>
						</ul>
					</div>
					<div class="col-md-6 footer-grid-left">
						<ul>
							<li><a href="typography.html">Typography</a></li>
							<li><a href="blog.html">Blog</a></li>
							<li><a href="contact.html">Contact</a></li>
						</ul>
					</div>
					<div class="clearfix"> </div>
				</div>
				<div class="col-md-4 footer-left">
					<h4>Newsletter</h4>
					<p>Subscribe With Us</p>
					<form action="#" method="post">
					
						<input type="email" placeholder="Subscribe" name="Subscribe" required="">
						<button class="btn1">Go</button>
					</form>
				</div>
				<div class="clearfix"> </div>
			</div>
		</div>
	</footer>
	<!-- footer -->
	<!-- copyright -->
	<div class="copyright">
		<div class="container">
			<p>Copyright &copy; 2017.Company name All rights reserved.More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a></p>
		</div>
	</div>
	<!-- //copyright -->
	<script src="js/SmoothScroll.min.js"></script>
<script type="text/javascript" src="js/move-top.js"></script>
<script type="text/javascript" src="js/easing.js"></script>
	<!-- here stars scrolling icon -->
	<script type="text/javascript">
		$(document).ready(function() {
			/*
				var defaults = {
				containerID: 'toTop', // fading element id
				containerHoverID: 'toTopHover', // fading element hover id
				scrollSpeed: 1200,
				easingType: 'linear' 
				};
			*/
								
			$().UItoTop({ easingType: 'easeOutQuart' });
								
			});
	</script>
<!-- //here ends scrolling icon -->
</div>
</body>	
<script>
var vm = new Vue({
  el: '#app',
  data: {
	tags:[
	"萌","cute","萌的一批",
	],
	itemId:'',//商品id
	imgUrl:"images/1.jpg",
	provider:"lwl",
	time:"June 2, 2015 ",
	des:"this is our lovly pet",
	Number:0,
	price:0,
	name:"",//这是用来标记当前宠物的名字
	userId:"21343",
	Select:"",
	itemIDs:[],


  },
  created(){
	  //载入值
	  	  //载入值
	  var thisURL = document.URL;      
		var  getval =thisURL.split('?')[1];    
		var showval= getval.split("=")[1]; 

		console.log(getval.split("="));
		var temp1= showval.split('&')[0];
		this.name=temp1;
		this.imgUrl = getval.split("=")[2];
	console.log(this.name);
				this.initDate(this.name);

		this.userId= session.getAttribute("account");
		console.log(this.userId);


  },
  methods:{
	  initDate(name){
		 var settings = {
  "async": true,
  "crossDomain": true,
  "url": "http://localhost:8090/getItemListByProduct?productId="+name,
  "method": "GET",
  "headers": {
    "accept": "application/json, text/javascript, */*; q=0.01",
    "origin": "http://www.imomoe.in",
    "user-agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36",
    "accept-encoding": "gzip, deflate",
    "accept-language": "zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,ja-JP;q=0.6,ja;q=0.5",
    "cookie": "SUV=1910281515459002; debug_uuid=C8A857128E50000189F5185010801F6F; gidinf=x099980108ee1088614f5e057000986c8949127b14d3; IPLOC=CN; t=1583134907936; spinfo=cXF8NzIzQ0MxMDc4RTk2MjlBNjk4REQ2OTgxODQxOTg2RTd8MTAwNjc3NzI5MjM1MA==; spsession=MTAwNjc3NzI5MjM1MHwxNTg0NjI0NDI4fDE1ODY1OTE4NjN8cXExMDA2Nzc3MjkyMzUw-qnNN8fRsugUcJOpt8bsGbdG9HA8=",
    "cache-control": "no-cache",
    "postman-token": "618389f9-b3d2-ad1a-f1b1-7f66273ec93e"
  }
}
self = this;
$.ajax(settings).done(function (response) {
  console.log(response);

	test =  response.data.itemList;
	for(var i =0; i < test.length; i++){
		console.log(test[i]);
		self.itemIDs.push(test[i].itemid);

	}
	console.log(self.itemIDs);


  temp = response.data.itemList[0];
  
  self.itemId=temp.itemid;
  self.price= temp.listprice;
//  self.imgUrl =
});




var settings = {
  "async": true,
  "crossDomain": true,
  "url": "http://localhost:3000/get_session",
  "method": "GET",
  "headers": {
    "accept": "application/json, text/javascript, */*; q=0.01",
 
  },
  "processData": false,
  "contentType": false,
  "mimeType": "multipart/form-data",
}

$.ajax(settings).done(function (response) {
  console.log(response);
  self.userId = response;
});

	  },
	  clickAdd(){
		  console.log('click add button')
		  	console.log('load');
			
	  },


	clickS(test){
		console.log(test);
		this.itemId = test;
	},
	

	  //购买商品
	  buy(){


		  console.log('buy'),
		  console.log(this.Number);

		  if(this.Number>100){
			alert("库存不够");
			return;
		  };

		  var test = this.Number * this.price;
		  var settings = {
					"async": true,
					"crossDomain": true,
					"url": "http://localhost:8090/insertTheItemToCart",
					"method": "POST",
					"headers": {
						"accept": "application/json, text/javascript, */*; q=0.01",
						"origin": "http://www.imomoe.in",
						"user-agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36",
						"accept-encoding": "gzip, deflate",
						"accept-language": "zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,ja-JP;q=0.6,ja;q=0.5",
						"cookie": "SUV=1910281515459002; debug_uuid=C8A857128E50000189F5185010801F6F; gidinf=x099980108ee1088614f5e057000986c8949127b14d3; IPLOC=CN; t=1583134907936; spinfo=cXF8NzIzQ0MxMDc4RTk2MjlBNjk4REQ2OTgxODQxOTg2RTd8MTAwNjc3NzI5MjM1MA==; spsession=MTAwNjc3NzI5MjM1MHwxNTg0NjI0NDI4fDE1ODY1OTE4NjN8cXExMDA2Nzc3MjkyMzUw-qnNN8fRsugUcJOpt8bsGbdG9HA8=",
						"content-type": "application/json",
						"cache-control": "no-cache",
						"postman-token": "686aea89-87da-80b5-5c7d-d748d29a9c63"
					},
					"processData": false,
					"data": "{\"userid\":\""+this.userId+"\",\"itemid\":\""+this.itemId+"\",\"productid\":\""+this.name+"\",\"name\":\""+this.itemId+"\",\"instock\":true,\"quantity\":"+this.Number+",\"listprice\":"+this.price+",\"total\":"+test+"}"
					}

					$.ajax(settings).done(function (response) {
					console.log(response);
				   ans = response.data.result;
				   if (ans == "1"){
					alert("success");
				   }else{
					   alert(ans);
				   }
					});
	  }

  }
  
})
</script>
</html>